<!DOCTYPE html>
<html>
<!-- Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.
 See LICENSE in the project root for license information -->

<head>

    <!--During development turn off caching-->
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />


    <script src="lib/jQuery.js"></script>
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js" type="text/javascript"></script>
    
        <!--Notice that during the preview, Office.js must be referenced from this interim location-->
    <!--<script src="https://officejscommands.azurewebsites.net/office.js" type="text/javascript"></script>-->
    
    <!--<script src="insert.js" type="text/javascript"></script>-->
    
    <script>
        // The initialize function must be run each time a new page is loaded
        (function () {
            Office.initialize = function (reason) {
               //If you need to initialize something you can do so here. 
            };
        })();

        
        
            //Notice function needs to be in global execution context
        function writeText(event) {

            //Consult Office.js API reference to see all you can do. This just shows the simplest action. 

            Office.context.document.setSelectedDataAsync("ExecuteFunction Works. Button ID=" + event.source.id,
                function (asyncResult) {
                    var error = asyncResult.error;
                    if (asyncResult.status === "failed") {
                        //show error. Upcoming displayDialog API will help here.
                    }
                    else {
                        //show success.Upcoming displayDialog API will help here.
                    }
                });
           //Required, call event.completed to let the platform know you are done processing. 
           
               // From http://stackoverflow.com/questions/934012/get-image-data-in-javascript, Matthew Crumley
            // Create an empty canvas element
    //          var canvas = document.createElement("canvas");
    //         canvas.width = img.width;
    //         canvas.height = img.height;
            
    //         // Copy the image contents to the canvas.    
    //         var myImage = document.getElementById('imageToInsert');
    //              var ctx = canvas.getContext("2d");
    // ctx.drawImage(myImage, 0, 0)   
            
    //            // Get the data-URL formatted image
    //             // Firefox supports PNG and JPEG. You could check img.src to
    //             // guess the original format, but be aware the using "image/jpg"
    //             // will re-encode the image.
    //             var dataURL = canvas.toDataURL("image/png");    
                
    //             var base64Image = dataURL.replace(/^data:image\/(png|jpg);base64,/, "");
                
                // Word.run(function (context) {
                //     // Create a proxy object for the range at the current selection.
                //     var imageRange = context.document.getSelection();
                            
                //     // Load the selected range.
                //     context.load(imageRange, 'text');
                
                //     // Synchronize the document state by executing the queued commands, 
                //     // and return a promise to indicate task completion.
                //     return context.sync()
                //         .then(function () {
                //             // Queue a command to insert the image into the document.
                //             var insertedImage = imageRange.insertInlinePictureFromBase64(base64Image, Word.InsertLocation.replace);
                                    
                //             // Queue a command to navigate the UI to the insert picture.
                //             insertedImage.select();
                //         })
                //     // Synchronize the document state by executing the queued commands.
                //         .then(context.sync);
                // })
                //     .catch(function(error) {
                //         console.log('Error: ' + JSON.stringify(error));
                //         if (error instanceof OfficeExtension.Error) {
                //             console.log('Debug info: ' + JSON.stringify(error.debugInfo));
                //         }
                //     });
           
	   event.completed();
        }

    </script>

</head>

<body>
    <!--<img id="imageToInsert" src="media/map.png"></img>-->
</body>

</html>